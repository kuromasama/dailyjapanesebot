# 📖 README.md (操作手冊) - N2 衝刺版

## 🇯🇵 AI 日文斯巴達家教 (N2 Spartan Bot: Sprint Edition)

這是一個不僅具備 **「情緒感知」** 與 **「解答延遲」**，更進化為擁有 **「N2 衝刺規劃」**、**「雙軌難度評估」** 與 **「動態弱點鎖定」** 的 AI 斯巴達家教。
它會根據你每天的努力程度與答題正確率，精算你距離 N2 合格還差幾天，決定要給你榮耀的讚賞，還是地獄般的催促。

---

## ✨ 核心功能詳解

### 1. 🗂️ 智慧單字與文法庫 (Smart Vocabulary & Grammar)
這不僅是一個單字本，而是一個會「記仇」的學習資料庫。

* **批量匯入**：支援直接貼上 JSON 格式文字，快速建立字庫。
* **彈性存詞**：支援 `空白` 或 `/` 分隔 (如 `漢字/假名/意思`)，方便手機輸入。
    > **新功能**：系統會自動偵測輸入內容，若包含 `~` 或 `...` 等符號，會自動歸類為 **「文法 (Grammar)」** 而非單字。
* **記憶強化 (Memory Reinforcement)**：
    * **手動輸入**：重複輸入同一單字時，權重增加。
    * **🚨 自動錯誤收錄 (Auto Mistake Capture)**：
        * **這是本版本的核心。** 當你在翻譯練習中犯錯（誤用單字或文法），AI 會自動將該錯誤項目加入資料庫，並給予 **極高的初始權重 (Count=5)**，確保你絕對忘不了它。

### 2. ⚖️ 動態權重演算法 (Dynamic Weighting System)
系統不再是隨機出題，而是根據你的熟練度動態調整每個字的出現機率。

* **懲罰機制 (Punishment)**：
    * 若在翻譯中被 AI 判定誤用某字，該字權重直接 **+2**。教練會記住你的失誤，並在未來的考試中瘋狂考你。
* **獎勵機制 (Reward)**：
    * 若在翻譯中正確使用了某個庫存單字（且 AI 未報錯），該字權重會 **大幅下降 (-2)**。熟練的單字會快速退場，讓你把時間花在刀口上。

### 3. 📊 雙軌難度與 3D 評分系統 (Dual-Track & 3D Scoring)
**這是 v24 的重大升級。** 你的「閱讀（輸入）」與「寫作（輸出）」能力現在被分開評估。

* **雙軌難度 (Dual-Track Difficulty)**：
    * **中翻日等級 (`difficulty_cn_jp`)**：專注於你的助詞精準度、動詞活用與產出能力。
    * **日翻中等級 (`difficulty_jp_cn`)**：專注於你的閱讀理解與翻譯信達雅。
    * *註：兩者獨立升降，互不影響。*
* **3D 評分與即時反應**：
    * AI 不再只給總評，而是針對你的 **每一句回答** 進行 **0.0~10.0** 的評分。
    * **評分標準**：準確度、流暢度、以及 **🔥 挑戰加分**（使用了進階語彙或精彩的換句話說）。
    * **難度連動規則**：
        * **神級 (≥9.0)**：難度 **+0.1** (大幅獎勵)。
        * **合格 (≥7.0)**：難度 **+0.05** (穩定進步)。
        * **不及格 (<6.0)**：難度 **-0.1** (打回重練)。
* **🛡️ 防偷懶機制 (Anti-Slacking)**：
    * 若你交白卷或亂打（0.0 分），系統會標記為 **SKIPPED**。這 **不會** 降低難度！別想透過偷懶來騙取降級。

### 4. 📝 全能雙向批改 & 品質紅線 (Bi-directional Analysis)
* **雙向語言識別**：
    * **中翻日**：AI 會開啟「極度嚴格」模式，檢查助詞 (てにをは)、動詞變化與時態。
    * **日翻中**：AI 會評估你的中文翻譯是否「信、達、雅」。
* **🚫 品質紅線 (Quality Redlines)**：
    * Prompt 中內建了嚴格的「防火牆」，嚴禁 AI 生成 **「中式日文 (Chinglish)」** 或 **「翻譯腔中文」**。參考答案保證是母語人士等級的道地用法。
* **三種說法**：
    * 批改時提供 **正式 (Formal)**、**口語 (Casual)**、**換句話說 (Paraphrase)** 三種版本，訓練你的語彙豐富度。

### 5. 🏃 N2 衝刺模式 & 🎯 弱點特訓 (Sprint & Weakness Targeting)
系統預設為 **180 天 N2 衝刺計畫** (可調整)。

* **每日必修 (Daily Mission)**：
    * 每天第一次執行 (通常是 12:05) 發送 **10 題**。
    * **弱點強攻演算法**：這 10 題並非隨機！
        * **中翻日 (7題)**：強制包含 **2 題** 你權重最高（最常錯）的弱點單字/文法。
        * **日翻中 (3題)**：強制包含 **1 題** 你的弱點單字/文法。
        * *沒有弱點？那就隨機出題，直到你犯錯為止。*
    * **進度警報**：系統會計算「理論上今天該有的等級」vs「你目前的等級」。若落後，教練會毫不留情地用數據（落後天數）來進行情緒勒索。
* **Bonus 無限挑戰 (Infinite Mode)**：
    * **觸發條件**：當日已領題後再次執行，或你的等級已超過 N2 (Lv 4.0)。
    * **無限難度**：打破 Lv5 天花板，向 Lv6 (母語者)、Lv7 (文學)、Lv8 (神之領域) 邁進。
    * **加分機制**：寫了 Bonus，明天教練會把你誇上天。

### 6. 🧠 AI 智能評級指令 (`[CH]`)
覺得進度太慢或太快？你可以直接與 AI 溝通調整。

* **自動評估**：輸入 `[CH]`
    * AI 會閱讀你過去 50 筆翻譯紀錄，綜合分析你的「助詞準確度」、「動詞活用熟練度」，給出一個精確的等級 (如 Lv 2.4)。
* **手動跳級**：輸入 `[CH] N3` 或 `[CH] 3.5`
    * 強制設定目前難度。

### 7. 📊 學習儀表板與日誌 (Log Dashboard)
所有的對話與批改紀錄都會被保存到 `TG_MSG.log`。

* **置頂儀表板**：Log 檔的最上方會有一個 Markdown 表格，顯示你目前的 **中翻日等級、日翻中等級、衝刺進度 (Day X/180)、連續登入天數、累積答題數**。
* **完整紀錄**：包含 AI 的詳細教學、除錯建議，方便日後複習 Debug。

---

## 🕹️ 使用指南與測資 (Test Data)

請直接複製以下內容傳送給 Telegram 機器人進行測試。

### A. 匯入單字/文法 (Import)

直接傳送 JSON，系統會自動判斷類別：

```json
[
  {"kanji": "成長", "kana": "せいちょう", "meaning": "成長", "type": "word"},
  {"kanji": "~てはいけない", "meaning": "禁止做...", "type": "grammar"}
]

```

### B. 存單字 (Add Word/Grammar)

直接輸入文字，支援 **空白** 或 **斜線** 分隔。
*若包含 `~` 等符號，系統會自動標記為文法。*

```text
我慢/がまん/忍耐
~しかない//只好...

```

### C. 翻譯/交作業 (Practice)

支援 **多行傳送**。系統偵測到訊息就會自動觸發批改 (包含手動執行時)。

**範例回答：**

```text
明日は雨が降るそうです。
ここは撮影してはいけません。
（針對不會的題目可以直接留白或寫中文，AI 會教你）

```

### D. 調整等級 (Level Adjustment)

```text
[CH]
(讓 AI 評估我的實力)

[CH] N2
(我已經是 N2 了，直接跳級)

```

---

## ⚠️ 重要提醒 (Limitations)

1. **API 額度限制**：
* 本專案使用 Google Gemini 免費版 API。
* 雖然有省流機制，但若頻繁手動執行 `[CH]` 評估或大量 Bonus，仍需留意每日上限。


2. **手動批改與 Log 機制**：
* **手動執行 (Manual Trigger)**：現在只要你手動按 Run，且 Telegram 有新的未讀訊息，程式 **會** 立即進行批改並寫入 Log。
* **Log 保存**：請確保你的 GitHub Actions Workflow (`.yml`) 中有包含 `git add TG_MSG.log` 的步驟，否則雲端執行完的紀錄會隨著虛擬機重置而消失。


3. **關於難度**：
* **Lv 1.0 ~ 3.9**：屬於 **「N2 衝刺期」**，會有進度落後的壓力與警告。
* **Lv 4.0 以上**：進入 **「無限挑戰期」**，不再催促進度，而是追求語言的極致。



```

我同時更新 Canvas 文件以反映這些格式優化。


http://googleusercontent.com/immersive_entry_chip/0

---

## ⚠️ 重要提醒 (Limitations)

1.  **API 額度限制**：
    * 本專案使用 Google Gemini 免費版 API。
    * 雖然有省流機制，但若頻繁手動執行 `[CH]` 評估或大量 Bonus，仍需留意每日上限。

2.  **手動批改與 Log 機制**：
    * **手動執行 (Manual Trigger)**：現在只要你手動按 Run，且 Telegram 有新的未讀訊息，程式 **會** 立即進行批改並寫入 Log。
    * **Log 保存**：請確保你的 GitHub Actions Workflow (`.yml`) 中有包含 `git add TG_MSG.log` 的步驟，否則雲端執行完的紀錄會隨著虛擬機重置而消失。

3.  **關於難度**：
    * **Lv 1.0 ~ 3.9**：屬於 **「N2 衝刺期」**，會有進度落後的壓力與警告。
    * **Lv 4.0 以上**：進入 **「無限挑戰期」**，不再催促進度，而是追求語言的極致。

